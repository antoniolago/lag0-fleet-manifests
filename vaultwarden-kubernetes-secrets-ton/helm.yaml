---
apiVersion: source.toolkit.fluxcd.io/v1
kind: OCIRepository
metadata:
  name: vaultwarden-kubernetes-secrets
  namespace: vaultwarden-kubernetes-secrets
spec:
  interval: 12h
  url: oci://harbor.lag0.com.br/charts/vaultwarden-kubernetes-secrets
  ref:
    semver: "1.0.1"
---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: vaultwarden-kubernetes-secrets
  namespace: vaultwarden-kubernetes-secrets
spec:
  releaseName: vaultwarden-kubernetes-secrets
  targetNamespace: vaultwarden-kubernetes-secrets
  timeout: 20s
  install:
    createNamespace: false
  interval: 30m
  chartRef:
    kind: OCIRepository
    name: vaultwarden-kubernetes-secrets
  values:
    debug: false
    global:
      imageTag: "1.0.1"
    image:
      pullPolicy: IfNotPresent
    replicaCount: 1
    dashboard:
      enabled: false
    api:
      enabled: false
    resources:
      requests:
        cpu: 10m
        memory: 128Mi
      limits:
        cpu: 1000m
        memory: 1024Mi
    # Ingress Configuration
    ingress:
      enabled: false

    env:
      config:
        VAULTWARDEN__SERVERURL: "https://vw.lag0.com.br"
        VAULTWARDEN__ORGANIZATIONID: "86e471e6-d04f-420f-aab6-6eb683cf9aa3"
        VAULTWARDEN__ORGANIZATIONNAME: "kubernetes-secrets"
        VAULTWARDEN__EMAIL: "antonio.lago.eu@hotmail.com"
        VAULTWARDEN__FOLDERID: ""
        VAULTWARDEN__FOLDERNAME: ""
        VAULTWARDEN__COLLECTIONID: ""
        VAULTWARDEN__COLLECTIONNAME: ""
        KUBERNETES__INCLUSTER: "true"
        KUBERNETES__DEFAULTNAMESPACE: "default"
        SYNC__DRYRUN: "false"
        SYNC__DELETEORPHANS: "true"
        SYNC__SECRETPREFIX: ""
        SYNC__SYNCINTERVALSECONDS: "30"
        SYNC__CONTINUOUSSYNC: "true"
        LOGGING__LOGLEVEL__DEFAULT: "Information"
        LOGGING__LOGLEVEL__MICROSOFT: "Warning"
        LOGGING__LOGLEVEL__MICROSOFT__HOSTING__LIFETIME: "Information"